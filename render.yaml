services:
  - type: web
    name: powergy-analytics
    env: docker
    plan: starter
    healthCheckPath: /
    autoDeploy: true
    envVars:
      - key: DATABASE_URL
        sync: false
      - key: OPENAI_API_KEY
        sync: false
      - key: KYOS_URL
        value: https://gas.kyos.com/
      - key: APP_BASE_URL
        value: https://spravy.powergy.sk

  - type: cron
    name: powergy-scraper-daily
    env: docker
    schedule: "0 8 * * *"
    dockerCommand: python -c "import sys; sys.path.insert(0, '/app'); from app.scraper import run_daily_agsi; run_daily_agsi()"
    envVars:
      - key: DATABASE_URL
        sync: false
      - key: OPENAI_API_KEY
        sync: false
      - key: AGSI_API_KEY
        sync: false
      - key: KYOS_URL
        value: https://gas.kyos.com/
